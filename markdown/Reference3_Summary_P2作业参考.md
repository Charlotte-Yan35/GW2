# Reference3 文献总结：对 P2 电网动力学作业的关键信息

> **文献来源**: Smith et al., "The effect of renewable energy incorporation on power grid stability and resilience", *Science Advances*, 8, eabj6734 (2022)
>
> **作业**: Math3060/1 Project 2 (ii) Power Grid Dynamics

---

## 1. 核心模型：Swing Equation

论文使用的模型与作业要求**完全一致**：

### 主方程
$$\frac{d^2\theta_i}{dt^2} + \gamma\frac{d\theta_i}{dt} = P_i - \kappa\sum_{j=1}^{n}A_{ij}\sin(\theta_i - \theta_j)$$

### 功率流计算
$$f_{ij} = \kappa\sin(\theta_i - \theta_j)$$

### 参数说明
| 符号 | 含义 |
|------|------|
| θ_i(t) | 节点i的相位角偏离 |
| γ | 惯性阻尼系数 |
| κ | 全局耦合强度 |
| P_i | 节点i的功率（正=发电，负=消费） |
| A_ij | 网络邻接矩阵 |

---

## 2. 稳定性分析方法

### 2.1 两节点系统的分岔分析（入门案例）

- **设置**: 1个发电机 (P₁ = P) + 1个消费者 (P₂ = -P)
- **结果**: 在临界耦合 κ_c = P 处发生**鞍结点分岔**
- **稳定条件**: κ_c / P ≤ 1

> 💡 **建议**: 这是一个很好的分析起点，可以画出分岔图（见论文Fig.1A）

### 2.2 临界耦合 κ_c 的数值计算

对于复杂网络，κ_c 需要数值求解：
1. 对不同 κ 值求解稳态方程
2. 找到时间步进无法收敛到稳态的临界值

### 2.3 关键发现

- **最优配置**: 发电机和消费者数量相近时，κ_c 最小（最易同步）
- **网络拓扑影响**: 更随机的网络（q 值越大）越容易同步

---

## 3. 网络结构研究

### 3.1 Watts-Strogatz 网络模型

论文使用此模型生成不同拓扑的网络：

| 参数 q | 网络类型 | 特点 |
|--------|----------|------|
| q = 0 | 规则格子 | 高聚类，长路径 |
| q = 0.1 | 小世界网络 | 高聚类，短路径 |
| q = 1 | 随机网络 | 低聚类，短路径 |

### 3.2 节点配置空间（单纯形）

用三元组 (n₊, n₋, n_p) 表示网络配置：
- n₊: 发电机数量
- n₋: 消费者数量
- n_p: 被动节点数量（净功率≈0）

约束: n₊ + n₋ + n_p = n

---

## 4. 级联故障分析

### 4.1 两种故障机制

1. **过载故障 (Overload)**: 边上功率 f_e > α（容量阈值）
2. **去同步故障 (Desynchronization)**: 相位差 |Δθ| > 1 Hz

### 4.2 级联故障算法（可直接参考实现）

```
Algorithm: Dynamic Cascade
Input: 网络 G = (V, E, P, α)
Output: 存活边比例 S

1. 求解稳态 θ*
2. 删除功率最大的边（触发故障）
3. 找到所有连通分量
4. 对每个分量调用 NETMON 函数监控
5. 返回 S = 存活边数 / 总边数

NETMON 函数:
- 持续时间步进求解方程(1)
- 若频率超限 → 返回 S=0
- 若找到稳态 → 返回当前边数
- 若边过载 → 删除过载边，递归调用
```

### 4.3 弹性度量

- **S**: 级联后存活边的比例（S=1完全弹性，S=0完全崩溃）
- **ρ = α_c / α***: 归一化临界容量（ρ越小越有弹性）
- **分布**: ρ 服从**对数正态分布**

### 4.4 关键发现

- 灾难性级联发生在 **20-30秒** 内
- 在 α ≈ α_c 时，过载和去同步故障大约各占一半
- **防护必须是预防性的**，而非响应性的

---

## 5. 真实数据的使用

### 5.1 数据源（与作业推荐相同）

| 数据类型 | 来源 | 分辨率 |
|----------|------|--------|
| 家庭用电消费 | UK Power Networks, 伦敦~5000户 | 30分钟 |
| PV太阳能发电 | UK Power Networks, 100个面板 | 10分钟 |

### 5.2 数据处理方法

**节点净功率**:
$$P_i(t) = g_i(t) - c_i(t)$$

其中 g_i(t) 是发电，c_i(t) 是消费。

**配置密度映射**:
$$\eta_+ = \frac{1}{n \cdot \max(P)} \sum_{x \in P^+} x$$
$$\eta_- = \frac{1}{n \cdot \min(P)} \sum_{x \in P^-} x$$
$$\eta_p = 1 - \eta_+ - \eta_-$$

### 5.3 微电网模型

- 网络大小 n，其中 n-1 个节点是住户
- 1 个节点是 **PCC (Point of Common Coupling)**，连接外部电网
- PCC 作为源或汇，平衡供需

---

## 6. 核心研究发现

### 6.1 弹性呈日周期性波动

- 电网状态随昼夜用电/发电模式在配置单纯形上移动
- 大部分时间运行在**弹性最差的区域**（单纯形边缘）

### 6.2 高 PV 渗透率可能降低弹性

- 发电输出在时间上高度集中（白天）
- 导致大功率流，使电网易受级联故障影响
- 夏季 100% PV 覆盖时，临界容量 α_c 在 5-15 kW 范围
- 这接近低压输电线路的额定容量（4-15 kW）

### 6.3 电池的影响有限

- 家用电池（如 Tesla Powerwall 2）增加了家庭自给自足
- 但**未能改善网络弹性**
- 原因：现有电池优化个体自给，而非网络整体弹性
- 轨迹被限制在单纯形边缘（高 κ_c 和高 ρ 区域）

---

## 7. 对 P2 项目的建议

### 7.1 推荐的研究路径

1. **从两节点系统开始**:
   - 解析分析稳定性
   - 画分岔图
   - 理解基本动力学

2. **扩展到小型网络**:
   - 使用 Watts-Strogatz 模型生成网络
   - 测试不同 q 值的影响

3. **实现级联故障模拟**:
   - 参考论文 Algorithm 1 & 2
   - 追踪过载和去同步故障

4. **引入真实数据**:
   - 使用伦敦智能电表数据
   - 研究不同 PV 渗透率的影响

### 7.2 可探索的研究问题

| 方向 | 具体问题 |
|------|----------|
| 网络结构 | 不同 q 值如何影响弹性？ |
| 功率变化 | 季节/昼夜变化如何影响稳定性？ |
| 级联故障 | 什么网络特征能遏制故障传播？ |
| 电池策略 | 如何优化电池调度以提高网络弹性？ |

### 7.3 可复现的关键图表

- Fig.1: κ_c 随网络配置的变化（单纯形热力图）
- Fig.2: 级联故障的幸存率 vs 边容量
- Fig.3: ρ 的对数正态分布
- Fig.4: 日功率曲线和单纯形轨迹
- Fig.5: κ_c 的日周期性波动

---

## 8. 参考文献信息

```
@article{smith2022effect,
  title={The effect of renewable energy incorporation on power grid stability and resilience},
  author={Smith, Oliver and Cattell, Oliver and Farcot, Etienne and O'Dea, Reuben D and Hopcraft, Keith I},
  journal={Science Advances},
  volume={8},
  number={9},
  pages={eabj6734},
  year={2022},
  doi={10.1126/sciadv.abj6734}
}
```

**代码仓库**: https://doi.org/10.5281/zenodo.5702877

---

*本文档为 P2 Power Grid Dynamics 小组作业的参考文献总结*
